<!DOCTYPE html>
<html lang="zh-CN">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Layered Lookbook</title>
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        html {
            overflow: hidden;
        }

        body {
            min-height: 100vh;
            background: #ffffff;
            overflow: hidden;
        }

        .page-container {
            height: 100vh;
            overflow: hidden;
            position: relative;
        }

        .pages-wrapper {
            transition: transform 0.8s cubic-bezier(0.65, 0, 0.35, 1);
        }

        /* ========== 第一部分：图层入场动画 ========== */
        .hero-section {
            position: relative;
            width: 100vw;
            height: 100vh;
            background: #ffffff;
            overflow: hidden;
        }

        /* 图层容器 - 全屏宽度，顶部对齐 */
        .layers-container {
            position: relative;
            width: 100vw;
            height: auto;
        }

        /* 每个图层 */
        .layer {
            position: absolute;
            top: 0;
            left: 0;
            width: 100%;
            opacity: 0;
            transform: translateY(100vh) scale(0.5);
            animation: flyIn 1s ease-out forwards;
            pointer-events: none;
            will-change: transform, opacity, filter;
            backface-visibility: hidden;
            -webkit-backface-visibility: hidden;
        }

        /* 图层1特殊处理：只淡入 */
        .layer.layer-1 {
            transform: translateY(0) scale(1);
            animation: fadeInOnly 1s ease-out forwards;
        }

        .layer.animation-done {
            animation: none;
            opacity: 1;
            transform: translateY(0) scale(1);
            will-change: transform, filter;
        }

        .layer img {
            width: 100%;
            height: auto;
            display: block;
            will-change: auto;
        }

        @keyframes fadeInOnly {
            0% {
                opacity: 0;
            }
            100% {
                opacity: 1;
            }
        }

        @keyframes flyIn {
            0% {
                opacity: 0;
                transform: translateY(100vh) scale(0.5);
            }
            100% {
                opacity: 1;
                transform: translateY(0) scale(1);
            }
        }

        /* 入场标题 */
        .hero-title {
            position: absolute;
            bottom: 25%;
            left: 80px;
            font-family: 'Arial Black', 'Helvetica Neue', Arial, sans-serif;
            font-size: 64px;
            font-weight: 900;
            letter-spacing: 0.1em;
            text-transform: uppercase;
            color: #ffffff;
            text-shadow: 
                0 2px 10px rgba(0,0,0,0.3),
                0 4px 20px rgba(0,0,0,0.2),
                0 8px 40px rgba(0,0,0,0.1);
            opacity: 0;
            z-index: 100;
            pointer-events: none;
        }

        .hero-title.show {
            animation: fadeInTitle 1.5s ease-out forwards;
        }

        @keyframes fadeInTitle {
            0% {
                opacity: 0;
                transform: translateY(20px);
            }
            100% {
                opacity: 1;
                transform: translateY(0);
            }
        }

        /* 重播按钮 */
        .replay-btn {
            position: fixed;
            bottom: 30px;
            right: 30px;
            padding: 12px 24px;
            background: rgba(255,255,255,0.1);
            border: 1px solid rgba(255,255,255,0.2);
            border-radius: 30px;
            color: white;
            font-size: 12px;
            letter-spacing: 2px;
            cursor: pointer;
            z-index: 1000;
            transition: all 0.3s ease;
            font-family: system-ui, sans-serif;
        }

        .replay-btn:hover {
            background: rgba(255,255,255,0.2);
        }

        /* ========== 第二部分：作品集展示 ========== */
        .portfolio-section {
            position: relative;
            width: 100vw;
            height: 100vh;
            background: #ffffff;
            overflow: hidden;
        }

        /* 第二页标题初始隐藏 */
        .portfolio-header {
            opacity: 0;
            transform: translateY(20px);
            transition: opacity 0.8s ease, transform 0.8s ease;
        }

        .portfolio-header.visible {
            opacity: 1;
            transform: translateY(0);
        }

        .portfolio-header.hidden {
            opacity: 0 !important;
            pointer-events: none;
        }

        /* 全屏背景大图 */
        .portfolio-bg {
            position: absolute;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            opacity: 0;
            transition: opacity 0.5s ease;
            pointer-events: none;
        }

        .portfolio-bg img {
            width: 100%;
            height: 100%;
            object-fit: cover;
        }

        /* 上下虚化遮罩 */
        .portfolio-bg::before {
            content: '';
            position: absolute;
            top: 0;
            left: 0;
            right: 0;
            height: 80px;
            background: linear-gradient(to bottom, #ffffff, transparent);
            z-index: 1;
        }

        .portfolio-bg::after {
            content: '';
            position: absolute;
            bottom: 0;
            left: 0;
            right: 0;
            height: 80px;
            background: linear-gradient(to top, #ffffff, transparent);
            z-index: 1;
        }

        .portfolio-bg.active {
            opacity: 1;
        }

        /* 内容容器 */
        .portfolio-content {
            position: relative;
            width: 100%;
            height: 100%;
            padding: 60px 80px;
            z-index: 10;
        }

        /* 左上角标题 */
        .portfolio-header {
            position: absolute;
            top: 60px;
            left: 80px;
        }

        .portfolio-title {
            font-family: 'Helvetica Neue', Arial, sans-serif;
            font-size: 48px;
            font-weight: 700;
            letter-spacing: 0.15em;
            text-transform: uppercase;
            color: #000;
            margin-bottom: 25px;
            line-height: 1.1;
        }

        .portfolio-subtitle {
            font-family: 'Helvetica Neue', Arial, sans-serif;
            font-size: 14px;
            font-weight: 400;
            letter-spacing: 0.15em;
            color: #666;
            line-height: 2;
        }

        .portfolio-subtitle span {
            display: block;
        }

        .portfolio-divider {
            width: 60px;
            height: 2px;
            background: #000;
            margin: 20px 0;
        }

        /* 作品网格 - 2x2 右下角 */
        .works-grid {
            position: absolute;
            bottom: 60px;
            right: 80px;
            display: grid;
            grid-template-columns: repeat(2, 280px);
            grid-template-rows: repeat(2, 200px);
            gap: 20px;
        }

        /* 单个作品项 */
        .work-item {
            position: relative;
            border-radius: 4px;
            overflow: visible;
            cursor: pointer;
            transition: opacity 0.4s ease;
        }

        .work-item.hidden {
            opacity: 0;
            pointer-events: none;
        }

        .work-item-inner {
            position: relative;
            width: 100%;
            height: 100%;
            border-radius: 4px;
            overflow: hidden;
        }

        .work-item img {
            width: 100%;
            height: 100%;
            object-fit: cover;
            transition: filter 0.4s ease;
        }

        .work-item.active img {
            filter: grayscale(100%);
        }

        /* 作品信息 - 从小图左边延伸 */
        .work-info {
            position: absolute;
            top: 50%;
            right: 100%;
            transform: translateY(-50%);
            padding-right: 20px;
            opacity: 0;
            pointer-events: none;
            transition: opacity 0.4s ease;
            white-space: nowrap;
        }

        .work-item.active .work-info {
            opacity: 1;
        }

        .work-info-inner {
            text-align: right;
        }

        .work-name {
            font-family: 'Helvetica Neue', Arial, sans-serif;
            font-size: 24px;
            font-weight: 700;
            color: #000;
            text-shadow: 
                0 0 20px rgba(255,255,255,0.9),
                0 0 40px rgba(255,255,255,0.8),
                2px 2px 4px rgba(255,255,255,0.9);
            margin-bottom: 8px;
        }

        .work-desc {
            font-family: 'Helvetica Neue', Arial, sans-serif;
            font-size: 13px;
            font-weight: 400;
            color: #333;
            text-shadow: 
                0 0 15px rgba(255,255,255,0.9),
                0 0 30px rgba(255,255,255,0.8),
                1px 1px 3px rgba(255,255,255,0.9);
            line-height: 1.6;
            max-width: 300px;
            white-space: normal;
        }

        /* 第三部分 */
        .spacer-section {
            height: 100vh;
            display: flex;
            align-items: center;
            justify-content: center;
            color: rgba(0,0,0,0.2);
            font-family: system-ui, sans-serif;
            background: #ffffff;
        }

        /* 加载提示 */
        .loading-info {
            position: fixed;
            top: 20px;
            left: 20px;
            color: rgba(255,255,255,0.5);
            font-size: 12px;
            font-family: monospace;
            z-index: 1000;
        }
    </style>
</head>
<body>

    <div class="loading-info" id="loadingInfo">Loading layers...</div>

    <div class="page-container">
        <div class="pages-wrapper" id="pagesWrapper">
            <!-- 第一部分：图层入场 -->
            <section class="hero-section">
                <div class="layers-container" id="layersContainer">
                    <!-- 图层会由JS自动生成 -->
                </div>
                <h1 class="hero-title" id="heroTitle">to the future</h1>
            </section>

            <!-- 第二部分：作品集展示 -->
            <section class="portfolio-section">
                <!-- 全屏背景大图 -->
                <div class="portfolio-bg" id="portfolioBg1">
                    <img src="./works/work_01_bg.JPG" alt="Work 1 Background">
                </div>
                <div class="portfolio-bg" id="portfolioBg2">
                    <img src="./works/work_02_bg.JPG" alt="Work 2 Background">
                </div>
                <div class="portfolio-bg" id="portfolioBg3">
                    <img src="./works/work_03_bg.JPG" alt="Work 3 Background">
                </div>
                <div class="portfolio-bg" id="portfolioBg4">
                    <img src="./works/work_04_bg.JPG" alt="Work 4 Background">
                </div>

                <div class="portfolio-content">
                    <!-- 左上角标题 -->
                    <div class="portfolio-header" id="portfolioHeader">
                        <div class="portfolio-title">Selected Works</div>
                        <div class="portfolio-divider"></div>
                        <div class="portfolio-subtitle">
                            <span>Creative Portfolio</span>
                            <span>2019 — 2024</span>
                        </div>
                    </div>

                    <!-- 作品网格 2x2 -->
                    <div class="works-grid">
                        <div class="work-item" data-index="1">
                            <div class="work-item-inner">
                                <img src="./works/work_01.JPG" alt="Work 1">
                            </div>
                            <div class="work-info">
                                <div class="work-info-inner">
                                    <div class="work-name">Project Alpha</div>
                                    <div class="work-desc">Brand identity design and visual system for a tech startup.</div>
                                </div>
                            </div>
                        </div>
                        <div class="work-item" data-index="2">
                            <div class="work-item-inner">
                                <img src="./works/work_02.JPG" alt="Work 2">
                            </div>
                            <div class="work-info">
                                <div class="work-info-inner">
                                    <div class="work-name">Project Beta</div>
                                    <div class="work-desc">Editorial design and art direction for print magazine.</div>
                                </div>
                            </div>
                        </div>
                        <div class="work-item" data-index="3">
                            <div class="work-item-inner">
                                <img src="./works/work_03.JPG" alt="Work 3">
                            </div>
                            <div class="work-info">
                                <div class="work-info-inner">
                                    <div class="work-name">Project Gamma</div>
                                    <div class="work-desc">Interactive web experience and motion graphics.</div>
                                </div>
                            </div>
                        </div>
                        <div class="work-item" data-index="4">
                            <div class="work-item-inner">
                                <img src="./works/work_04.JPG" alt="Work 4">
                            </div>
                            <div class="work-info">
                                <div class="work-info-inner">
                                    <div class="work-name">Project Delta</div>
                                    <div class="work-desc">Photography and visual storytelling campaign.</div>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
            </section>
        </div>
    </div>

    <button class="replay-btn" onclick="replayAnimation()">重新播放</button>

    <script>
        // ============================================================
        // ==================== 配置区域 - 修改这里 ====================
        // ============================================================

        const CONFIG = {
            // 图层配置
            layers: {
                // 图片路径前缀（你的图片文件夹路径）
                basePath: './layers/',
                
                // 图片命名格式：layer_01.png, layer_02.png, ...
                // layer_01 在最底层，layer_30 在最上层
                prefix: 'layer_',
                suffix: '.PNG',
                
                // 总共多少个图层
                count: 11,
                
                // 每层入场的间隔时间（秒）
                delayStep: 0.08,
                
                // 入场动画时长（秒）
                animationDuration: 1.2,
            },

            // Banner配置
            banner: {
                basePath: './banner/',
                prefix: 'banner_',
                suffix: '.jpg',
                count: 8,
            },

            // 容器尺寸（根据你的图片比例调整）
            container: {
                width: 1200,
                height: 800,
            }
        };

        // 获取图层图片路径
        function getLayerPath(index) {
            const num = String(index).padStart(2, '0');
            return `${CONFIG.layers.basePath}${CONFIG.layers.prefix}${num}${CONFIG.layers.suffix}`;
        }

        // 获取Banner图片路径
        function getBannerPath(index) {
            const num = String(index).padStart(2, '0');
            return `${CONFIG.banner.basePath}${CONFIG.banner.prefix}${num}${CONFIG.banner.suffix}`;
        }

        // ============================================================
        // ==================== 以下代码不需要修改 ====================
        // ============================================================

        const container = document.getElementById('layersContainer');
        const loadingInfo = document.getElementById('loadingInfo');

        // 设置容器全屏
        container.style.width = '100vw';
        container.style.height = '100vh';

        // 生成图层 - 优化版：预加载所有图片
        function createLayers() {
            container.innerHTML = '';
            loadingInfo.textContent = '加载中... 0%';
            loadingInfo.style.opacity = '1';
            
            const totalLayers = CONFIG.layers.count;
            let loadedCount = 0;
            const layers = [];
            const images = [];
            
            // 先创建所有图层但不显示
            for (let i = 1; i <= totalLayers; i++) {
                const layer = document.createElement('div');
                layer.className = 'layer';
                
                // 图层1特殊class
                if (i === 1) {
                    layer.classList.add('layer-1');
                }
                
                layer.style.zIndex = i;
                layer.style.animationDelay = `${(i - 1) * CONFIG.layers.delayStep}s`;
                layer.style.animationDuration = `${CONFIG.layers.animationDuration}s`;
                layer.style.animationPlayState = 'paused'; // 先暂停动画
                
                layer.addEventListener('animationend', () => {
                    layer.classList.add('animation-done');
                });
                
                const img = document.createElement('img');
                img.alt = `Layer ${i}`;
                
                layers.push(layer);
                images.push({ img, index: i });
                
                layer.appendChild(img);
                container.appendChild(layer);
            }
            
            // 预加载所有图片
            images.forEach(({ img, index }) => {
                const tempImg = new Image();
                tempImg.onload = () => {
                    img.src = tempImg.src;
                    loadedCount++;
                    const percent = Math.round((loadedCount / totalLayers) * 100);
                    loadingInfo.textContent = `加载中... ${percent}%`;
                    
                    // 全部加载完成后开始动画
                    if (loadedCount === totalLayers) {
                        loadingInfo.textContent = '加载完成！';
                        setTimeout(() => {
                            // 开始所有动画
                            layers.forEach(layer => {
                                layer.style.animationPlayState = 'running';
                            });
                            loadingInfo.style.opacity = '0';
                            
                            // 入场动画完成后显示标题
                            const totalAnimationTime = (totalLayers - 1) * CONFIG.layers.delayStep * 1000 + CONFIG.layers.animationDuration * 1000;
                            setTimeout(() => {
                                document.getElementById('heroTitle').classList.add('show');
                            }, totalAnimationTime);
                        }, 300);
                    }
                };
                tempImg.onerror = () => {
                    loadedCount++;
                    const percent = Math.round((loadedCount / totalLayers) * 100);
                    loadingInfo.textContent = `加载中... ${percent}%`;
                    
                    // 加载失败的显示占位
                    img.style.display = 'none';
                    const layer = layers[index - 1];
                    layer.style.background = `hsl(${index * 12}, 40%, 90%)`;
                    
                    if (loadedCount === totalLayers) {
                        loadingInfo.textContent = '加载完成！';
                        setTimeout(() => {
                            layers.forEach(layer => {
                                layer.style.animationPlayState = 'running';
                            });
                            loadingInfo.style.opacity = '0';
                            
                            // 入场动画完成后显示标题
                            const totalAnimationTime = (totalLayers - 1) * CONFIG.layers.delayStep * 1000 + CONFIG.layers.animationDuration * 1000;
                            setTimeout(() => {
                                document.getElementById('heroTitle').classList.add('show');
                            }, totalAnimationTime);
                        }, 300);
                    }
                };
                tempImg.src = getLayerPath(index);
            });
        }

        // 重播动画
        function replayAnimation() {
            const layers = document.querySelectorAll('.layer');
            layers.forEach(layer => {
                layer.style.animation = 'none';
                layer.offsetHeight; // 强制重排
                layer.style.animation = '';
                layer.style.animationPlayState = 'running';
            });
        }

        // ============================================================
        // ==================== 鼠标位置互动效果 ====================
        // ============================================================
        
        // 当前页面（0=第一页，1=第二页）- 会被全屏滚动控制更新
        let currentPage = 0;
        
        // 色相变化配置 - 指定哪些图层需要色相变化
        const hueShiftLayers = [11]; // 图层11
        let currentHueShift = 0;
        let targetHueShift = 0;
        
        // 视差位移
        let mouseX = 0.5;
        let mouseY = 0.5;
        let currentMouseX = 0.5;
        let currentMouseY = 0.5;
        
        // 呼吸动画
        let breathTime = 0;
        const breathSpeed = 0.015;
        
        // 缓存DOM元素
        let cachedLayers = null;
        let cachedHueLayers = null;
        
        function cacheLayers() {
            cachedLayers = document.querySelectorAll('.layer.animation-done');
            cachedHueLayers = [];
            document.querySelectorAll('.layer').forEach((layer, i) => {
                if (hueShiftLayers.includes(i + 1)) {
                    cachedHueLayers.push(layer);
                }
            });
        }
        
        // 更新色相滤镜
        function updateHueFilter() {
            if (!cachedHueLayers) return;
            cachedHueLayers.forEach(layer => {
                layer.style.filter = `hue-rotate(${currentHueShift}deg)`;
            });
        }
        
        // 更新视差位移（关闭呼吸动画测试）
        function updateParallax() {
            // 每次检查缓存是否完整
            const allDoneLayers = document.querySelectorAll('.layer.animation-done');
            if (!cachedLayers || cachedLayers.length < allDoneLayers.length) {
                cachedLayers = allDoneLayers;
            }
            
            if (cachedLayers.length === 0) return;
            
            const layerCount = CONFIG.layers.count;
            cachedLayers.forEach((layer, i) => {
                // 图层1不参与视差
                if (i === 0) return;
                
                const depth = (i + 1) / layerCount;
                
                const moveX = (currentMouseX - 0.5) * depth * 50;
                const moveY = (currentMouseY - 0.5) * depth * 30;
                
                layer.style.transform = `translate(${moveX}px, ${moveY}px)`;
            });
        }
        
        // 动画循环 - 暂时关闭测试频闪
        let animationId = null;
        let lastFrameTime = 0;
        const frameInterval = 1000 / 30;
        
        function animateMouseEffects(timestamp) {
            // 暂时关闭动画，测试是否是动画导致频闪
            // animationId = requestAnimationFrame(animateMouseEffects);
            return;
        }
        
        // 鼠标移动监听
        document.addEventListener('mousemove', (e) => {
            if (currentPage !== 0) return;
            
            mouseX = e.clientX / window.innerWidth;
            mouseY = e.clientY / window.innerHeight;
            targetHueShift = (mouseX - 0.5) * 100;
        });
        
        // 鼠标离开窗口时复原
        document.addEventListener('mouseleave', () => {
            mouseX = 0.5;
            mouseY = 0.5;
            targetHueShift = 0;
        });
        
        // 入场动画完成后缓存图层
        setTimeout(cacheLayers, 3000);
        
        // 启动动画循环
        animateMouseEffects();

        // ============================================================
        // ==================== 作品集交互 ====================
        // ============================================================
        
        const workItems = document.querySelectorAll('.work-item');
        const portfolioHeader = document.getElementById('portfolioHeader');
        const portfolioBgs = [
            document.getElementById('portfolioBg1'),
            document.getElementById('portfolioBg2'),
            document.getElementById('portfolioBg3'),
            document.getElementById('portfolioBg4')
        ];

        workItems.forEach((item, index) => {
            item.addEventListener('mouseenter', () => {
                // 隐藏标题
                portfolioHeader.classList.add('hidden');
                
                // 隐藏其他作品项
                workItems.forEach((otherItem, otherIndex) => {
                    if (otherIndex !== index) {
                        otherItem.classList.add('hidden');
                    }
                });
                
                // 当前项激活（灰度）
                item.classList.add('active');
                
                // 显示对应的背景大图
                portfolioBgs[index].classList.add('active');
            });

            item.addEventListener('mouseleave', () => {
                // 恢复标题
                portfolioHeader.classList.remove('hidden');
                
                // 恢复所有作品项
                workItems.forEach(otherItem => {
                    otherItem.classList.remove('hidden');
                });
                
                // 取消当前项激活
                item.classList.remove('active');
                
                // 隐藏背景大图
                portfolioBgs[index].classList.remove('active');
            });
        });

        // ============================================================
        // ==================== 全屏滚动控制 ====================
        // ============================================================
        
        const pagesWrapper = document.getElementById('pagesWrapper');
        const totalPages = 2;
        let isAnimating = false;
        let portfolioHeaderShown = false;

        function goToPage(pageIndex) {
            if (isAnimating || pageIndex < 0 || pageIndex >= totalPages) return;
            if (pageIndex === currentPage) return;
            
            isAnimating = true;
            currentPage = pageIndex;
            
            pagesWrapper.style.transform = `translateY(-${pageIndex * 100}vh)`;
            
            // 第二页标题淡入
            if (pageIndex === 1 && !portfolioHeaderShown) {
                setTimeout(() => {
                    portfolioHeader.classList.add('visible');
                    portfolioHeaderShown = true;
                }, 400);
            }
            
            // 回到第一页时重置
            if (pageIndex === 0) {
                portfolioHeaderShown = false;
                portfolioHeader.classList.remove('visible');
            }
            
            setTimeout(() => {
                isAnimating = false;
            }, 800);
        }

        // 鼠标滚轮控制翻页
        let wheelThrottle = null;
        document.addEventListener('wheel', (e) => {
            e.preventDefault();
            
            if (wheelThrottle) return;
            
            wheelThrottle = setTimeout(() => {
                wheelThrottle = null;
            }, 100);
            
            if (e.deltaY > 30) {
                goToPage(currentPage + 1);
            } else if (e.deltaY < -30) {
                goToPage(currentPage - 1);
            }
        }, { passive: false });

        // 触摸滑动支持
        let touchStartY = 0;
        document.addEventListener('touchstart', (e) => {
            touchStartY = e.touches[0].clientY;
        }, { passive: true });

        document.addEventListener('touchend', (e) => {
            const touchEndY = e.changedTouches[0].clientY;
            const diff = touchStartY - touchEndY;
            
            if (Math.abs(diff) > 50) {
                if (diff > 0) {
                    goToPage(currentPage + 1);
                } else {
                    goToPage(currentPage - 1);
                }
            }
        }, { passive: true });

        // 键盘支持
        document.addEventListener('keydown', (e) => {
            if (e.key === 'ArrowDown' || e.key === 'PageDown') {
                goToPage(currentPage + 1);
            } else if (e.key === 'ArrowUp' || e.key === 'PageUp') {
                goToPage(currentPage - 1);
            }
        });

        // 初始化
        createLayers();
    </script>
</body>
</html>
